<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="EvaluationMapper">

  <resultMap type="Lecture.Evaluation.evaluation.EvaluationDTO" id="EvaluationMap">
    <id column="evaluationID"   property="evaluationID"/>
    <result column="userID"  property="userID"/>
    <result column="lectureName"    property="lectureName"/>
    <result column="professorName" property="professorName"/>
    <result column="lectureYear" property="lectureYear"/>
    <result column="semesterDivide" property="semesterDivide"/>
    <result column="lectureDivide" property="lectureDivide"/>
    <result column="evaluationTitle" property="evaluationTitle"/>
    <result column="evaluationContent" property="evaluationContent"/>
    <result column="totalScore" property="totalScore"/>
    <result column="creditScore" property="creditScore"/>
    <result column="characterScore" property="characterScore"/>
    <result column="likeCount" property="likeCount"/>
    
    
  </resultMap>
  
  <select id="selectList" resultMap="EvaluationMap">
    select 
    	evaluationID,
      userID, 
      lectureName, 
      professorName, 
      lectureYear,
      semesterDivide,
      lectureDivide,
      evaluationTitle,
      evaluationContent,
      totalScore,
      creditScore,
      characterScore,
      likeCount
      
    from 
      EVALUATION
    where lectureDivide like #{lecutreDivide} AND CONCAT(lectureName,professorName,evaluationTitle,evaluationContent)
    like #{search}
						
    order by 
     evaluationID DESC LIMIT " + pageNumber*5 + ","+pageNumber*5 +6;
  </select>
  
  <insert id="writeEvaluation" parameterType="EvaluationDTO">
    INSERT INTO EVALUATION(#{userID ,jdbcType=VARCHAR},
    lectureName,
   	professorName,
   	lectureYear,
   	 semesterDivide,
   	 lectureDivide,
   	 evaluationTitle,
   	 evaluationContent,
   	 totalScore,
   	 creditScore,
   	 characterScore,
   	 likeCount
   	 ) 
    values(#{userID},   #{lectureName},
   	#{professorName},
   	#{lectureYear},
   	 #{semesterDivide},
   	#{ lectureDivide},
   	 #{evaluationTitle},
   	#{ evaluationContent},
   	 #{totalScore},
   	 #{creditScore},
   	#{ characterScore},
   	 #{likeCount})
  </insert>
  
  <select id="selectId" resultMap="EvaluationMap" parameterType="int">
    SELECT userID
     FROM EVALUATION 
     WHERE evaluationID =#{evaluationID}
    
   
  </select>
  
  <update id="updateLike" parameterType="EvaluationDTO">
    update evaluation set
      likeCount=#{likeCount+1}
    where evaluationID=#{evaluationID}
  </update>
  
  <delete id="deleteBoard" parameterType="int">
    DELETE FROM EVALUATION 
    WHERE evaluationID = #{evaluationID}
   
  </delete>
</mapper>
